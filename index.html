<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Car Goal Pro</title>

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="–ö–æ–ø–∏–ª–∫–∞">
    
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        body { 
            background-color: #0b0b0b; 
            color: white; 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; 
            height: 100vh; 
            display: flex; 
            flex-direction: column; 
            overflow: hidden; 
            margin: 0;
            padding-top: env(safe-area-inset-top);
        }
        
        .target-title { font-weight: 900; font-style: italic; text-align: center; transition: all 0.5s ease; line-height: 1.1; }
        .style-normal { color: #ff3b30; text-shadow: 0 0 25px rgba(255, 59, 48, 0.6); font-size: 3.2rem; }
        .style-urgent { color: #ffcc00; text-shadow: 0 0 30px rgba(255, 204, 0, 0.7); font-size: 2rem; animation: pulse 1.5s infinite; }
        .style-late { color: #ff3b30; text-shadow: 0 0 35px #ff3b30; font-size: 2rem; animation: shake 0.5s infinite; }
        .style-ok { color: #007AFF; text-shadow: 0 0 20px #007AFF; font-size: 2.5rem; }
        
        @keyframes pulse { 0%, 100% { opacity: 1; transform: scale(1); } 50% { opacity: 0.7; transform: scale(0.95); } }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-4px); } 75% { transform: translateX(4px); } }
        
        .car-mask { 
            position: relative; width: 90%; height: 260px; 
            -webkit-mask-image: url('car-outline.png'); mask-image: url('car-outline.png'); 
            -webkit-mask-size: contain; mask-size: contain; 
            -webkit-mask-repeat: no-repeat; -webkit-mask-position: center; 
            background: rgba(255, 255, 255, 0.05); 
        }
        .liquid-fill { 
            position: absolute; bottom: 0; width: 100%; height: 0%; 
            background: linear-gradient(180deg, #007AFF 0%, #00f2ff 100%); 
            transition: height 2s cubic-bezier(0.4, 0, 0.2, 1); 
            box-shadow: 0 0 40px rgba(0, 122, 255, 0.5); 
        }
        
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        .btn-disabled { background-color: #1a1a1a; color: #444; }
        .btn-active { background-color: #007AFF; color: white; }
    </style>
</head>
<body>

    <div id="mainTitle" onclick="handleSecretReset()" class="target-title style-normal mt-12 uppercase cursor-pointer">500 000!</div>
    <p id="infoLabel" class="text-center text-gray-700 text-[10px] font-black tracking-[0.3em] uppercase mt-4">–í –ü–†–û–¶–ï–°–°–ï...</p>

    <div class="flex-grow flex items-center justify-center relative" onclick="handleCarClick()">
        <div class="car-mask">
            <div id="paintLevel" class="liquid-fill"></div>
        </div>
        <img src="car-outline.png" class="absolute pointer-events-none opacity-20 w-[90%] h-full object-contain">
    </div>

    <div class="p-6 space-y-4 bg-white/5 backdrop-blur-xl rounded-t-[40px] border-t border-white/10 pb-12">
        <input type="number" id="sumInput" pattern="\d*" inputmode="decimal" placeholder="–°–£–ú–ú–ê –ü–û–ü–û–õ–ù–ï–ù–ò–Ø ‚Ç∏" class="w-full bg-black/50 border border-white/10 rounded-2xl py-4 text-center text-xl font-bold outline-none text-white focus:border-blue-500">
        
        <input type="file" id="fileField" class="hidden" onchange="fileUploaded()">
        <label for="fileField" id="fileStatus" class="flex items-center justify-center gap-2 w-full py-3 border border-dashed border-gray-700 rounded-2xl text-gray-600 text-[10px] font-bold cursor-pointer uppercase">
            <span>üìé –ü–†–ò–ö–†–ï–ü–ò–¢–¨ –ß–ï–ö</span>
        </label>

        <button id="submitBtn" onclick="doPayment()" disabled class="btn-disabled w-full py-4 rounded-2xl font-black uppercase tracking-widest text-sm transition-all">–ü–û–ü–û–õ–ù–ò–¢–¨</button>
        
        <div class="grid grid-cols-5 gap-1 opacity-20 mt-2">
            <div class="text-[8px] font-black text-center uppercase">–Ø–ù–í</div>
            <div class="text-[8px] font-black text-center uppercase">–§–ï–í</div>
            <div class="text-[8px] font-black text-center uppercase">–ú–ê–†</div>
            <div class="text-[8px] font-black text-center uppercase">–ê–ü–†</div>
            <div class="text-[8px] font-black text-center uppercase">–ú–ê–ô</div>
        </div>
    </div>

    <script>
        const GOAL = 500000;
        const MONTHLY_GOAL = 100000;
        
        let currentTotal = 0;
        let monthlyTotal = 0;

        function loadData() {
            currentTotal = parseFloat(localStorage.getItem('total_saved')) || 0;
            monthlyTotal = parseFloat(localStorage.getItem('monthly_saved')) || 0;
            
            const now = new Date();
            const currentMonthKey = now.getMonth() + "-" + now.getFullYear();
            
            if (localStorage.getItem('last_update_month') !== currentMonthKey) {
                localStorage.setItem('prev_month_total', monthlyTotal);
                monthlyTotal = 0;
                localStorage.setItem('monthly_saved', 0);
                localStorage.setItem('last_update_month', currentMonthKey);
            }

            refreshUI();
            updateHeader();
        }

        function fileUploaded() {
            const btn = document.getElementById('submitBtn');
            btn.disabled = false;
            btn.classList.replace('btn-disabled', 'btn-active');
            document.getElementById('fileStatus').innerHTML = "‚úÖ –ß–ï–ö –í–´–ë–†–ê–ù";
            document.getElementById('fileStatus').classList.add('text-blue-500', 'border-blue-500');
        }

        function doPayment() {
            const val = parseFloat(document.getElementById('sumInput').value);
            if (!val || val <= 0) return;

            currentTotal += val;
            monthlyTotal += val;

            localStorage.setItem('total_saved', currentTotal);
            localStorage.setItem('monthly_saved', monthlyTotal);
            
            resetForm();
            refreshUI();
            updateHeader();
        }

        function refreshUI() {
            const fill = Math.min((currentTotal / GOAL) * 100, 100);
            document.getElementById('paintLevel').style.height = fill + '%';
        }

        function updateHeader() {
            const day = new Date().getDate();
            const title = document.getElementById('mainTitle');
            const prevMonthTotal = parseFloat(localStorage.getItem('prev_month_total')) || 0;

            if (day === 30) {
                if (monthlyTotal < MONTHLY_GOAL) {
                    title.innerText = "–û–ü–õ–ê–¢–ò–¢–ï –°–ß–ï–¢!";
                    title.className = "target-title style-urgent mt-12 uppercase";
                } else {
                    title.innerText = "–ü–õ–ê–ù –í–´–ü–û–õ–ù–ï–ù!";
                    title.className = "target-title style-ok mt-12 uppercase";
                }
            } else if (day >= 1 && day <= 5) {
                if (prevMonthTotal < MONTHLY_GOAL && monthlyTotal < MONTHLY_GOAL) {
                    title.innerText = "–í–´ –ù–ê –ü–†–û–°–†–û–ß–ö–ï!";
                    title.className = "target-title style-late mt-12 uppercase";
                } else {
                    title.innerText = "–ü–†–ò–ù–Ø–¢–û ‚úÖ";
                    title.className = "target-title style-ok mt-12 uppercase";
                }
            } else {
                title.innerText = "500 000!";
                title.className = "target-title style-normal mt-12 uppercase";
            }
        }

        function resetForm() {
            document.getElementById('sumInput').value = "";
            document.getElementById('fileField').value = "";
            const btn = document.getElementById('submitBtn');
            btn.disabled = true;
            btn.className = "btn-disabled w-full py-4 rounded-2xl font-black uppercase tracking-widest text-sm";
            document.getElementById('fileStatus').innerHTML = "üìé –ü–†–ò–ö–†–ï–ü–ò–¢–¨ –ß–ï–ö";
            document.getElementById('fileStatus').className = "flex items-center justify-center gap-2 w-full py-3 border border-dashed border-gray-700 rounded-2xl text-gray-600 text-[10px] font-bold cursor-pointer uppercase";
            document.activeElement.blur();
        }

        let carClicks = 0;
        function handleCarClick() {
            carClicks++;
            setTimeout(() => carClicks = 0, 1000);
            if (carClicks === 4) {
                const info = document.getElementById('infoLabel');
                const rem = Math.max(GOAL - currentTotal, 0);
                info.innerText = `–û–°–¢–ê–õ–û–°–¨: ${rem.toLocaleString()} ‚Ç∏`;
                info.classList.replace('text-gray-700', 'text-blue-500');
                setTimeout(() => {
                    info.innerText = "–í –ü–†–û–¶–ï–°–°–ï...";
                    info.classList.replace('text-blue-500', 'text-gray-700');
                }, 3000);
            }
        }

        let resetClicks = 0;
        function handleSecretReset() {
            resetClicks++;
            setTimeout(() => resetClicks = 0, 1500);
            if (resetClicks === 5) {
                if (confirm("–£–¥–∞–ª–∏—Ç—å –≤–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å –∏–∑ –ø–∞–º—è—Ç–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∞?")) {
                    localStorage.clear();
                    location.reload();
                }
            }
        }

        window.onload = loadData;
    </script>
</body>
</html>
